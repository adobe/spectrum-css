{
	"name": "tokens",
	"tag": ["tokens"],
	"namedInputs": {
		"core": ["{projectRoot}/custom-tokens.json"],
		"scripts": [
			"{projectRoot}/style-dictionary.config.js",
			"{projectRoot}/utilities/*.js"
		],
		"tools": ["{projectRoot}/postcss.config.js"]
	},
	"targets": {
		"build": {
			"cache": false,
			"dependsOn": ["clean"],
			"executor": "nx:run-commands",
			"inputs": [
				"core",
				"tools",
				{
					"externalDependencies": [
						"postcss",
						"postcss-cli",
						"prettier",
						"@adobe/spectrum-tokens"
					]
				}
			],
			"options": {
				"commands": [
					"style-dictionary build --config style-dictionary.config.js --verbose",
					"postcss ./dist/css/index.css ./dist/css/mobile.css --replace",
					"postcss ./dist/css/index.css ./dist/css/mobile.css --dir ./dist/css --ext min.css"
				],
				"cwd": "{projectRoot}",
				"parallel": false
			},
			"outputs": [
				"{projectRoot}/dist/css/index.css",
				"{projectRoot}/dist/css/mobile.css",
				"{projectRoot}/dist/css/index.min.css",
				"{projectRoot}/dist/css/mobile.min.css",
				"{projectRoot}/dist/json/tokens.json",
				"{projectRoot}/dist/json/raw.json"
			]
		},
		"clean": {
			"cache": false,
			"executor": "nx:run-commands",
			"inputs": ["{projectRoot}/dist", { "externalDependencies": ["rimraf"] }],
			"options": {
				"commands": [
					"rimraf {projectRoot}/dist",
					"test -d {projectRoot}/dist && echo \"Error: dist directory could not be removed\" && exit 1 || exit 0"
				],
				"parallel": false
			},
			"outputs": []
		},
		"compare": {
			"cache": true,
			"executor": "nx:run-commands",
			"inputs": [
				{ "externalDependencies": ["glob", "@adobe/token-diff-generator"] }
			],
			"options": {
				"commands": [
					"tdiff report --old-token-version @adobe/spectrum-tokens@{args.v1} --new-token-version @adobe/spectrum-tokens@{args.v2} --format markdown --output {projectRoot}/dist/tokens-diff.md"
				],
				"forwardAllArgs": true,
				"v1": "13.15.0"
			},
			"outputs": ["{projectRoot}/dist/tokens-diff.md"]
		},
		"format": {},
		"lint": {}
	}
}
