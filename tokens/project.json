{
	"name": "tokens",
	"tag": ["tokens"],
	"namedInputs": {
    "core": ["{projectRoot}/custom/*.css"],
		"scripts": ["{projectRoot}/style-dictionary.config.js", "{projectRoot}/utilities/*.js"],
		"tools": ["{projectRoot}/postcss.config.js"]
	},
	"targets": {
		"build": {
			"cache": false,
      "dependsOn": ["clean"],
			"executor": "nx:run-commands",
			"inputs": ["core", "tools", { "externalDependencies": ["postcss"] }],
      "options": {
        "commands": [
          "style-dictionary build --config style-dictionary.config.js --verbose",
          "postcss ./dist/css/index.css --replace",
          "postcss ./dist/css/index.css --dir ./dist/css --ext min.css",
          "prettier --write --cache --log-level error --ignore-unknown --no-error-on-unmatched-pattern ./dist/*/*"
        ],
        "cwd": "{projectRoot}",
        "parallel": false
      },
      "outputs": [
        "{projectRoot}/dist/css/index.css",
        "{projectRoot}/dist/css/index.min.css",
        "{projectRoot}/dist/json/tokens.json"
      ]
    },
    "clean": {
      "cache": false,
      "executor": "nx:run-commands",
      "inputs": ["{projectRoot}/dist", { "externalDependencies": ["rimraf"] }],
      "options": {
        "commands": [
          "rimraf {projectRoot}/dist",
          "test -d {projectRoot}/dist && echo \"Error: dist directory could not be removed\" && exit 1 || exit 0"
        ],
        "parallel": false
      },
      "outputs": []
    },
    "compare": {
      "cache": true,
      "executor": "nx:run-commands",
			"inputs": [{ "externalDependencies": ["glob", "@adobe/token-diff-generator"] }],
			"options": {
				"commands": [
					"tdiff report --old-token-version @adobe/spectrum-tokens@{args.v1} --new-token-version @adobe/spectrum-tokens@{args.v2} --format markdown --output ./dist/tokens-diff.md"
				],
				"forwardAllArgs": true,
				"v1": "13.10.0"
			},
      "outputs": ["{projectRoot}/dist/tokens-diff.md"]
    },
    "format": {},
    "lint": {}
  }
}
