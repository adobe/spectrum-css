/*!
 * Copyright 2024 Adobe. All rights reserved.
 *
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at <http://www.apache.org/licenses/LICENSE-2.0>
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 */

.spectrum-Tabs {
	--spectrum-tabs-item-height: var(--mod-tabs-item-height, var(--spectrum-tab-item-height-medium));
	--spectrum-tabs-start-to-edge: var(--mod-tabs-start-to-edge, var(--spectrum-tab-item-start-to-edge-medium));
	--spectrum-tabs-top-to-text: var(--mod-tabs-top-to-text, var(--spectrum-tab-item-top-to-text-medium));
	--spectrum-tabs-bottom-to-text: var(--mod-tabs-bottom-to-text, var(--spectrum-tab-item-bottom-to-text-medium));
	--spectrum-tabs-label-to-selection-indicator: var(--mod-tabs-label-to-selection-indicator, var(--spectrum-spacing-200));
	--spectrum-tabs-item-horizontal-spacing: var(--mod-tabs-item-horizontal-spacing, var(--spectrum-tab-item-to-tab-item-horizontal-medium));

	--spectrum-tabs-icon-size: var(--mod-tabs-icon-size, var(--spectrum-workflow-icon-size-75));
	--spectrum-tabs-icon-to-text: var(--mod-tabs-icon-to-text, var(--spectrum-text-to-visual-100));
	--spectrum-tabs-top-to-icon: var(--mod-tabs-top-to-icon, var(--spectrum-tab-item-top-to-workflow-icon-medium));
	--spectrum-tabs-side-to-icon: var(--mod-tabs-side-to-icon, var(--spectrum-tab-item-side-to-workflow-icon-medium));

	--spectrum-tabs-item-border-radius: var(--mod-tabs-item-border-radius, var(--spectrum-corner-radius-0));

	--spectrum-tabs-color: var(--highcontrast-tabs-color, var(--mod-tabs-color, var(--spectrum-neutral-subdued-content-color-default)));
	--spectrum-tabs-color-hover: var(--highcontrast-tabs-color-hover, var(--mod-tabs-color-hover, var(--spectrum-neutral-subdued-content-color-hover)));
	--spectrum-tabs-color-key-focus: var(--highcontrast-tabs-color-key-focus, var(--mod-tabs-color-key-focus, var(--spectrum-neutral-subdued-content-color-key-focus)));
	--spectrum-tabs-color-selected: var(--highcontrast-tabs-color-selected, var(--mod-tabs-color-selected, var(--spectrum-neutral-content-color-default)));
	--spectrum-tabs-color-selected-hover: var(--highcontrast-tabs-color-selected-hover, var(--mod-tabs-color-selected-hover, var(--spectrum-neutral-content-color-hover)));
	--spectrum-tabs-color-selected-key-focus: var(--highcontrast-tabs-color-selected-key-focus, var(--mod-tabs-color-selected-key-focus, var(--spectrum-neutral-content-color-key-focus)));
	--spectrum-tabs-color-disabled: var(--highcontrast-tabs-color-disabled, var(--mod-tabs-color-disabled, var(--spectrum-disabled-content-color)));
	--spectrum-tabs-selection-indicator-color-disabled: var(--highcontrast-tabs-selection-indicator-color-disabled, var(--mod-tabs-selection-indicator-color-disabled, var(--spectrum-disabled-border-color)));

	--spectrum-tabs-font-weight: var(--mod-tabs-font-weight, var(--spectrum-regular-font-weight));
	--spectrum-tabs-font-family: var(--mod-tabs-font-family, var(--spectrum-sans-font-family-stack));
	--spectrum-tabs-font-style: var(--mod-tabs-font-style, var(--spectrum-default-font-style));
	--spectrum-tabs-font-size: var(--mod-tabs-font-size, var(--spectrum-font-size-100));
	--spectrum-tabs-line-height: var(--mod-tabs-line-height, var(--spectrum-line-height-100));

	--spectrum-tabs-focus-indicator-width: var(--mod-tabs-focus-indicator-width, var(--spectrum-focus-indicator-thickness));
	--spectrum-tabs-focus-indicator-border-radius: var(--mod-tabs-focus-indicator-border-radius, var(--spectrum-corner-radius-300));
	--spectrum-tabs-focus-indicator-gap: var(--mod-tabs-focus-indicator-gap, var(--spectrum-focus-indicator-gap));
	--spectrum-tabs-focus-indicator-color: var(--highcontrast-tabs-focus-indicator-color, var(--mod-tabs-focus-indicator-color, var(--spectrum-focus-indicator-color)));

	--spectrum-tabs-selection-indicator-color: var(--highcontrast-tabs-selection-indicator-color, var(--mod-tabs-selection-indicator-color, var(--spectrum-neutral-subdued-content-color-down)));
	--spectrum-tabs-selection-indicator-thickness: var(--mod-tabs-selection-indicator-thickness, var(--spectrum-tab-selection-indicator-thickness));
	--spectrum-tabs-selection-indicator-border-radius: var(--mod-tabs-selection-indicator-border-radius, 2px); /* TODO: add token when there is one */

	--spectrum-tabs-animation-duration: var(--mod-tabs-animation-duration, var(--spectrum-animation-duration-100));
	--spectrum-tabs-animation-ease: var(--mod-tabs-animation-ease, var(--spectrum-animation-ease-in-out));
}

.spectrum-Tabs.spectrum-Tabs--compact {
	--spectrum-tabs-item-height: var(--mod-tabs-item-height-compact, var(--spectrum-tab-item-compact-height-medium));
	--spectrum-tabs-top-to-text: var(--mod-tabs-top-to-text-compact, var(--spectrum-tab-item-top-to-text-compact-medium));
	--spectrum-tabs-bottom-to-text: var(--mod-tabs-bottom-to-text-compact, var(--spectrum-tab-item-top-to-text-compact-medium));
	--spectrum-tabs-label-to-selection-indicator: var(--mod-tabs-label-to-selection-indicator-compact, var(--spectrum-spacing-75));
	--spectrum-tabs-item-horizontal-spacing: var(--mod-tabs-item-horizontal-spacing-compact, var(--spectrum-tab-item-to-tab-item-compact-horizontal-medium));
	--spectrum-tabs-top-to-icon: var(--mod-tabs-top-to-icon-compact, var(--spectrum-tab-item-top-to-workflow-icon-compact-medium));
	--spectrum-tabs-side-to-icon: var(--mod-tabs-side-to-icon-compact, var(--spectrum-tab-item-side-to-workflow-icon-compact-medium));
}

/* some tokens weren't defined/defined correctly, so these sections are temporary */
.spectrum-Tabs {
	--spectrum-tab-item-top-to-workflow-icon-medium: 14px; /* 14px desktop/18px mobile */
	--spectrum-tab-item-side-to-workflow-icon-medium: 6px; /* 6px desktop/mobile */
	--spectrum-tab-item-bottom-to-text-medium: 16px; /* 16px desktop/21px mobile */
	--spectrum-tab-item-to-tab-item-horizontal-medium: 32px; /* 32px desktop/30px mobile */
	--spectrum-tab-selection-indicator-thickness: 2px; /* 2px desktop/mobile */

	&.spectrum-Tabs--compact {
		--spectrum-tab-item-top-to-workflow-icon-compact-medium: 6px; /* 6px desktop/7px mobile */
		--spectrum-tab-item-side-to-workflow-icon-compact-medium: 6px; /* 6px desktop/mobile */
		--spectrum-tab-item-to-tab-item-compact-horizontal-medium: 24px; /* 24px desktop/30px mobile */
	}
}

.spectrum--large {
	.spectrum-Tabs {
		--spectrum-tab-item-top-to-workflow-icon-medium: 18px; /* 14px desktop/18px mobile */
		--spectrum-tab-item-side-to-workflow-icon-medium: 6px; /* 6px desktop/mobile */
		--spectrum-tab-item-bottom-to-text-medium: 21px; /* 16px desktop/21px mobile */
		--spectrum-tab-item-to-tab-item-horizontal-medium: 30px; /* 32px desktop/30px mobile */
		--spectrum-tab-selection-indicator-thickness: 2px; /* 2px desktop/mobile */

		&.spectrum-Tabs--compact {
			--spectrum-tab-item-top-to-workflow-icon-compact-medium: 7px; /* 6px desktop/7px mobile */
			--spectrum-tab-item-side-to-workflow-icon-compact-medium: 6px; /* 6px desktop/mobile */
			--spectrum-tab-item-to-tab-item-compact-horizontal-medium: 30px; /* 24px desktop/30px mobile */
		}
	}
}

/* @passthrough -- picker styling for overflow tabs */
.spectrum-Tabs .spectrum-Picker-button {
	--mod-picker-block-size: var(--spectrum-tabs-item-height);
}

.spectrum-Tabs {
	display: flex;
	gap: var(--spectrum-tabs-item-horizontal-spacing);

	/* Contain the selection indicator */
	position: relative;
	z-index: 0;

	margin: 0;
	padding-block: 0;

	/* Friends should align to the top of the tabs */
	vertical-align: top;
}

.spectrum-Tabs-item {
	/* Contain the focus ring */
	position: relative;
	box-sizing: border-box;

	block-size: var(--spectrum-tabs-item-height);

	/* Float above the tab line */
	z-index: 1;

	text-decoration: none;
	white-space: nowrap;

	color: var(--spectrum-tabs-color);

	transition: color var(--spectrum-tabs-animation-duration) ease-out;
	cursor: pointer;
	outline: none;
	border-radius: var(--spectrum-tabs-item-border-radius);

	.spectrum-Icon {
		/* Vertical centering */
		block-size: var(--spectrum-tabs-icon-size);
		inline-size: var(--spectrum-tabs-icon-size);
		margin-block-start: var(--spectrum-tabs-top-to-icon);
		margin-inline-start: var(--spectrum-tabs-side-to-icon);
		margin-inline-end: var(--spectrum-tabs-side-to-icon);

		& + .spectrum-Tabs-itemLabel {
			margin-inline-start: var(--spectrum-tabs-icon-to-text);
		}
	}

	&::before {
		content: "";
		position: absolute;
		box-sizing: border-box;

		block-size: calc(100% + var(--spectrum-tabs-focus-indicator-gap) * 2 + var(--spectrum-tabs-focus-indicator-width) * 2);
		inline-size: calc(100% + var(--spectrum-tabs-focus-indicator-gap) * 2 + var(--spectrum-tabs-focus-indicator-width) * 2);
		margin-block-start: calc(-1 * (var(--spectrum-tabs-focus-indicator-gap) + var(--spectrum-tabs-focus-indicator-width)));
		margin-block-end: calc(-1 * (var(--spectrum-tabs-focus-indicator-gap) + var(--spectrum-tabs-focus-indicator-width)));
		margin-inline-start: calc(-1 * (var(--spectrum-tabs-focus-indicator-gap) + var(--spectrum-tabs-focus-indicator-width)));
		margin-inline-end: calc(-1 * (var(--spectrum-tabs-focus-indicator-gap) + var(--spectrum-tabs-focus-indicator-width)));

		border: var(--spectrum-tabs-focus-indicator-width) solid transparent;
		border-radius: var(--spectrum-tabs-focus-indicator-border-radius);

		pointer-events: none;
	}

	&:hover {
		color: var(--spectrum-tabs-color-hover);
	}

	&.is-selected {
		color: var(--spectrum-tabs-color-selected);

		&:hover {
			color: var(--spectrum-tabs-color-selected-hover);
		}

		&:focus-visible {
			color: var(--spectrum-tabs-color-selected-key-focus);
		}

		&.is-disabled {
			color: var(--spectrum-tabs-selection-indicator-color-disabled);
		}
	}

	&.is-disabled {
		cursor: default;
		color: var(--spectrum-tabs-color-disabled);

		.spectrum-Tabs-itemLabel {
			cursor: default;
		}
	}

	&:focus-visible {
		color: var(--spectrum-tabs-color-key-focus);

		&::before {
			border-color: var(--spectrum-tabs-focus-indicator-color);
		}
	}
}

.spectrum-Tabs-itemLabel {
	cursor: pointer;
	display: inline-block;
	vertical-align: top;

	font-family: var(--spectrum-tabs-font-family);
	font-style: var(--spectrum-tabs-font-style);
	font-size: var(--spectrum-tabs-font-size);
	font-weight: var(--spectrum-tabs-font-weight);
	line-height: var(--spectrum-tabs-line-height);
	margin-block-start: var(--spectrum-tabs-top-to-text);
	margin-block-end: var(--spectrum-tabs-bottom-to-text);

	/* support links */
	text-decoration: none;

	&:empty {
		/* Hide the tab label if it's not being used */
		display: none;
	}
}

.spectrum-Tabs-selectionIndicator {
	position: absolute;
	inset-inline-start: 0;
	background-color: var(--spectrum-tabs-selection-indicator-color);

	/* Be below the tab */
	z-index: 0;

	/* @todo: set transition: none for initial positioning */
	transition: transform var(--spectrum-tabs-animation-duration) var(--spectrum-tabs-animation-ease);
	transform-origin: top left;

	border-radius: var(--spectrum-tabs-selection-indicator-border-radius);
}

.spectrum-Tabs--horizontal {
	align-items: center;

	.spectrum-Tabs-item {
		vertical-align: top;
	}

	.spectrum-Tabs-selectionIndicator {
		position: absolute;
		inset-block-end: 0;
		inline-size: 100%;
		block-size: var(--spectrum-tabs-selection-indicator-thickness);
		margin-block-start: var(--spectrum-tabs-label-to-selection-indicator);
	}

	&.spectrum-Tabs--compact {
		/* The overflow ActionButton is taller than the tabs, so don't push tabs around */
		box-sizing: content-box;
		align-items: end;
	}
}

.spectrum-Tabs--vertical,
.spectrum-Tabs--vertical-right {
	display: inline-flex;
	flex-direction: column;
	padding: 0;

	.spectrum-Tabs-item {
		block-size: var(--spectrum-tabs-item-height);
		line-height: var(--spectrum-tabs-item-height);
		padding-block: 0;

		margin-inline-start: var(--spectrum-tabs-start-to-edge);
		margin-inline-end:  var(--spectrum-tabs-start-to-edge);

		&::before {
			margin-inline-start: calc(-1 * var(--spectrum-tabs-focus-indicator-gap));
		}
	}

	.spectrum-Icon {
		line-height: var(--spectrum-tabs-item-height);
	}

	.spectrum-Tabs-selectionIndicator {
		position: absolute;
		inset-inline-start: calc(-1 * var(--spectrum-tabs-start-to-edge));
		inset-block-start: 0;
		inline-size: var(--spectrum-tabs-selection-indicator-thickness);
		block-size: 100%;
	}
}

.spectrum-Tabs--vertical-right {
	.spectrum-Tabs-selectionIndicator {
		inset-inline: auto calc(-1 * var(--spectrum-tabs-start-to-edge));
	}
}

@media (forced-colors: active) {
	.spectrum-Tabs {
		--highcontrast-tabs-selection-indicator-color: Highlight;
		--highcontrast-tabs-focus-indicator-color: CanvasText;
		--highcontrast-tabs-focus-indicator-background-color: Highlight;

		--highcontrast-tabs-color: ButtonText;
		--highcontrast-tabs-color-hover: ButtonText;
		--highcontrast-tabs-color-selected: HighlightText;
		--highcontrast-tabs-color-key-focus: ButtonText;
		--highcontrast-tabs-color-disabled: GrayText;
		--highcontrast-tabs-selection-indicator-color-disabled: GrayText;
		--highcontrast-tabs-color-selected-hover: HighlightText;
		--highcontrast-tabs-color-selected-key-focus: HighlightText;

		/* Prevents black box behind text on Highlight background */
		forced-color-adjust: none;

		.spectrum-Tabs-item {
			.spectrum-Icon {
				z-index: 1;
				position: relative;
			}

			.spectrum-Tabs-itemLabel {
				position: relative;
				z-index: 1;
			}
		}

		.is-selected {
			&::before {
				background-color: var(--highcontrast-tabs-focus-indicator-background-color);
			}

			&:focus,
			&:focus-visible {
				color: var(--highcontrast-tabs-color-selected);
			}
		}

		&.spectrum-Tabs--vertical.spectrum-Tabs--compact .spectrum-Tabs-item {
			&::before {
				block-size: 100%;
				inset-block-start: 0;
			}
		}
	}
}
